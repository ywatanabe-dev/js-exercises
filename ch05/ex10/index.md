### 比較結果

同一のオブジェクト`document`に対して、`with`文でプロパティにアクセスする場合と、
`with`文を使わないでプロパティにアクセスする場合の速度を比較した。
実際に比較に使用したコードが`index.cjs`と`index.js`である。
比較にはナノ秒単位で実行時間が計測できる`process.hrtime.bigint()`を使用し、
それぞれ10回ずつ実行した結果の平均を計算した。

- index.cjs(`with`文使用)の結果

  ```
  0.003958ms
  0.004ms
  0.004125ms
  0.004083ms
  0.004ms
  0.004084ms
  0.004042ms
  0.003917ms
  0.003958ms
  0.004125ms
  ```

  平均は、0.0040292msである。

- index.js(`with`文不使用)の結果

  ```
  0.000958ms
  0.001ms
  0.001041ms
  0.000958ms
  0.000917ms
  0.001ms
  0.001042ms
  0.000875ms
  0.001ms
  0.000958ms
  ```

  平均は、0.0009749msである。

### 実行時間の差の理由

上記の結果より、`with`文を使わない方が約4倍動作が速いことが分かる。
このような結果になる理由は、処理系による最適化の差であると考えられる。

[^1]のパフォーマンスの節の解説にあるように、`with`文内では非修飾識別子が`with`文で指定されたオブジェクトのプロパティである可能性があり、その参照先を仮定することができない。

今回の例では、`index.cjs`の`with`文内にある`name`、`address`、`email`各々の参照先を確定するにあたり、 実行時に`document.forms[0]`に対するプロパティチェックが行う必要があり、このことが最適化に対する妨げになっていると考えられる。

[^1]: https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Statements/with
